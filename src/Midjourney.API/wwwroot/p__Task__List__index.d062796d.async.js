"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{12154:function(ie,A,i){i.r(A),i.d(A,{default:function(){return Ie}});var D=i(97857),U=i.n(D),L=i(15009),h=i.n(L),j=i(99289),S=i.n(j),P=i(5574),f=i.n(P),N=i(27986),R=i(94272),x=i(66309),X=i(38703),ne=i(83062),Z=i(11499),M=i(74330),n=i(26412),le=i(86250),V=i(4393),e=i(85893),oe=function(w){var t=w.record,o=(0,R.useIntl)(),E=sessionStorage.getItem("mj-image-prefix")||"",B=function(s){var g="default";return s=="NOT_START"?g="default":s=="SUBMITTED"?g="lime":s=="MODAL"?g="warning":s=="IN_PROGRESS"?g="processing":s=="FAILURE"?g="error":s=="SUCCESS"?g="success":s=="CANCEL"&&(g="magenta"),(0,e.jsx)(x.Z,{color:g,children:t.displays.status})},F=function(s){var g=0;s&&s.indexOf("%")>0&&(g=parseInt(s.substring(0,s.indexOf("%"))));var b="normal";return t.status=="SUCCESS"?b="success":t.status=="FAILURE"&&(b="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(X.Z,{percent:g,status:b})})},p=function(s){return!s||s.length<30?s:(0,e.jsx)(ne.Z,{title:s,children:s.substring(0,30)+"..."})},y=function(s){return s&&(0,e.jsx)(Z.Z,{width:200,src:E+s,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},W=function(s){return s&&(0,e.jsx)("video",{width:"200",controls:!0,src:E+s,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},G=function(){return!t.videoUrls||t.videoUrls.length===0?null:(0,e.jsxs)("div",{className:"video-task-detail",children:[(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(x.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(x.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),(0,e.jsx)("div",{className:"videos-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:t.videoUrls.map(function(s,g){return(0,e.jsx)("div",{className:"video-detail-item",children:(0,e.jsxs)("div",{style:{position:"relative",marginBottom:"8px"},children:[(0,e.jsxs)("video",{controls:!0,loop:!0,muted:!0,style:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"8px"},poster:t.videoGenOriginImageUrl,children:[(0,e.jsx)("source",{src:s.url,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E\u3002"]}),(0,e.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["#",g+1]})]})},g)})}),t.videoGenOriginImageUrl&&(0,e.jsxs)("div",{style:{marginTop:"16px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px",fontWeight:"bold"},children:"\u539F\u59CB\u56FE\u7247:"}),y(t.videoGenOriginImageUrl)]})]})},z=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(x.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"||s=="FACE_SWAP"||s=="FACE_SWAP_VIDEO"?(0,e.jsx)(x.Z,{color:"volcano",children:"InsightFace"}):s=="MID_JOURNEY"?(0,e.jsx)(x.Z,{color:"blue",children:"Midjourney"}):"-"},$=function(s){if(!(s==null||!s))return(0,e.jsx)(x.Z,{color:"green",children:o.formatMessage({id:"pages.yes"})})},H=function(){return t.action==="SWAP_VIDEO_FACE"||t.contentType==="video/mp4"?(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.video"}),children:(0,e.jsx)(le.Z,{vertical:!0,children:W(t.imageUrl)})}):(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.image"}),children:y(t.imageUrl)})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{type:"inner",title:o.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:"ID",children:t.id}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.type"}),children:t.displays.action}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.status"}),children:B(t.status)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.progress"}),children:F(t.progress)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.prompt"}),children:p(t.prompt)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.promptEn"}),children:p(t.promptEn)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.description"}),children:p(t.description)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.submitTime"}),children:t.displays.submitTime}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.startTime"}),children:t.displays.startTime}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.finishTime"}),children:t.displays.finishTime}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.failReason"}),children:p(t.failReason)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.state"}),children:p(t.state)}),H(),(t.action==="VIDEO"||t.action==="VIDEO_EXTEND")&&t.videoDuration&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.Z.Item,{label:"\u89C6\u9891\u65F6\u957F",children:[t.videoDuration,"s"]}),(0,e.jsx)(n.Z.Item,{label:"\u5E27\u6570",children:t.frameCount})]})]})}),(0,e.jsx)(V.Z,{type:"inner",title:o.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.botType"}),children:z(t.botType)}),(0,e.jsx)(n.Z.Item,{label:"Nonce",children:t.nonce}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.account.channelId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.instanceId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:"Hash",children:t.properties.messageHash}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.messageContent"}),children:p(t.properties.messageContent)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.finalPrompt"}),children:p(t.properties.finalPrompt)}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.finalPromptZh"}),children:p(t.promptCn||"-")}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.actionId"}),children:p(t.properties.custom_id||"-")}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.modalConfirm"}),children:$(t.properties.needModel)||"-"}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.imageSeed"}),children:t.seed||"-"}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.notifyHook"}),children:p(t.properties.notifyHook||"-")}),(0,e.jsx)(n.Z.Item,{label:o.formatMessage({id:"pages.task.ip"}),children:t.clientIp||"-"})]})})]})},de=oe,K=i(66927),ue=i(74842),ce=i(82061),ge=i(90930),me=i(99191),fe=i(53025),pe=i(16568),Y=i(28036),he=i(86738),ve=i(28248),I=i(67294),xe=function(){var w=(0,I.useState)(!1),t=f()(w,2),o=t[0],E=t[1],B=(0,I.useState)({}),F=f()(B,2),p=F[0],y=F[1],W=(0,I.useState)(""),G=f()(W,2),z=G[0],$=G[1],H=(0,I.useState)({}),v=f()(H,2),s=v[0],g=v[1],b=(0,I.useState)(1e3),Q=f()(b,2),Se=Q[0],Me=Q[1],Ce=fe.Z.useForm(),Ze=f()(Ce,1),Ee=Ze[0],c=(0,R.useIntl)(),ye=sessionStorage.getItem("mj-image-prefix")||"",be=pe.ZP.useNotification(),q=f()(be,2),_=q[0],Te=q[1],ee=(0,I.useRef)(),Ae=function(){y({}),g({}),E(!1)},Ue=function(r,a,l,d){Ee.resetFields(),$(r),y(a),g(l),Me(d),E(!0)},Re=function(){var u=S()(h()().mark(function r(a){var l,d;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,(0,K._5)(a);case 3:l=m.sent,l.success?(_.success({message:"success",description:c.formatMessage({id:"pages.task.deleteSuccess"})}),(d=ee.current)===null||d===void 0||d.reload()):_.error({message:"error",description:l.message}),m.next=10;break;case 7:m.prev=7,m.t0=m.catch(0),console.error(m.t0);case 10:return m.prev=10,m.finish(10);case 12:case"end":return m.stop()}},r,null,[[0,7,10,12]])}));return function(a){return u.apply(this,arguments)}}(),Fe=(0,I.useState)(!0),te=f()(Fe,2),k=te[0],ke=te[1],J=function(){ke(!1)},we=function(r){return r&&(0,e.jsx)("video",{width:"200",controls:!0,src:ye+r,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},Oe=(0,I.useState)(!1),ae=f()(Oe,2),De=ae[0],se=ae[1],Le=(0,I.useState)(""),re=f()(Le,2),Pe=re[0],Ne=re[1],Ve=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(r,a){return(0,e.jsx)("a",{onClick:function(){return Ue(c.formatMessage({id:"pages.task.info"}),(0,e.jsx)(de,{record:a}),null,1100)},children:r})}},{title:c.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var u=S()(h()().mark(function a(){return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"},{label:"SwapVideoFace",value:"SWAP_VIDEO_FACE"},{label:"Video",value:"VIDEO"},{label:"Edit",value:"EDIT"},{label:"Retexture",value:"RETEXTURE"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.displays.action}},{title:c.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(r,a,l){return a.action==="SWAP_VIDEO_FACE"?a.thumbnailUrl&&(0,e.jsx)(Z.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:a.thumbnailUrl,preview:!1,onClick:function(){window.open(a.imageUrl)},loading:"lazy",onLoad:J,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(M.Z,{spinning:k})})},l):a.contentType==="video/mp4"?(0,e.jsxs)("div",{style:{position:"relative",cursor:"pointer",display:"inline-block"},onClick:function(){Ne(a.imageUrl||a.url),se(!0)},children:[a.thumbnailUrl&&(0,e.jsx)(Z.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:a.thumbnailUrl,preview:!1,loading:"lazy",onLoad:J,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(M.Z,{spinning:k})})},l),(0,e.jsx)(Y.ZP,{icon:(0,e.jsx)(ue.Z,{})})]}):(a.thumbnailUrl||a.imageUrl)&&(0,e.jsx)(Z.Z.PreviewGroup,{items:a.images||[],children:(0,e.jsx)(Z.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:a.thumbnailUrl||a.imageUrl,preview:{src:a.imageUrl,mask:(0,e.jsx)(M.Z,{spinning:k})},loading:"lazy",onLoad:J,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(M.Z,{spinning:k})})},l)})}},{title:c.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(r,a){return a.properties.discordInstanceId}},{title:c.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(r,a){return a.displays.submitTime}},{title:c.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var u=S()(h()().mark(function a(){return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:c.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:c.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:c.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:c.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:c.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:c.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:c.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){var l="default";return r=="NOT_START"?l="default":r=="SUBMITTED"?l="lime":r=="MODAL"?l="warning":r=="IN_PROGRESS"?l="processing":r=="FAILURE"?l="error":r=="SUCCESS"?l="success":r=="CANCEL"&&(l="magenta"),(0,e.jsx)(x.Z,{color:l,children:a.displays.status})}},{title:c.formatMessage({id:"pages.task.mode"}),dataIndex:"mode",width:90,align:"center",request:function(){var u=S()(h()().mark(function a(){return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"RELAX",value:"RELAX"},{label:"FAST",value:"FAST"},{label:"TURBO",value:"TURBO"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.mode||"FAST"}},{title:c.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(r,a){var l=0;r&&r.indexOf("%")>0&&(l=parseInt(r.substring(0,r.indexOf("%"))));var d="normal";return a.status=="SUCCESS"?d="success":a.status=="FAILURE"&&(d="exception"),(0,e.jsx)(X.Z,{percent:l,status:d,size:"small"})}},{title:c.formatMessage({id:"pages.task.useTime"}),dataIndex:"useTime",width:80,ellipsis:!0},{title:c.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:c.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:c.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(r,a){return(0,e.jsx)(he.Z,{title:c.formatMessage({id:"pages.task.delete"}),description:c.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Re(a.id)},children:(0,e.jsx)(Y.ZP,{danger:!0,icon:(0,e.jsx)(ce.Z,{})})})}}];return(0,e.jsxs)(ge._z,{children:[Te,(0,e.jsx)(V.Z,{children:(0,e.jsx)(me.Z,{columns:Ve,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:ee,request:function(){var u=S()(h()().mark(function r(a){var l,d,O;return h()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,K.Pn)(U()(U()({},a),{},{pageNumber:a.current-1}));case 2:return l=C.sent,d=l.list.map(function(T){return T.imageUrl||""}).filter(function(T){return T!=""}),O=l.list,O.forEach(function(T,Be){T.images=d}),C.abrupt("return",{data:O,total:l.pagination.total,success:!0});case 7:case"end":return C.stop()}},r)}));return function(r){return u.apply(this,arguments)}}()})}),(0,e.jsx)(N.Z,{title:z,modalVisible:o,hideModal:Ae,modalContent:p,footer:s,modalWidth:Se}),(0,e.jsx)(ve.Z,{title:"\u89C6\u9891\u64AD\u653E",open:De,onCancel:function(){return se(!1)},footer:null,width:800,centered:!0,destroyOnClose:!0,children:(0,e.jsxs)("video",{controls:!0,autoPlay:!0,width:"100%",style:{maxHeight:"400px"},children:[(0,e.jsx)("source",{src:Pe,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E"]})})]})},Ie=xe},27986:function(ie,A,i){var D=i(28248),U=i(85893),L=function(j){var S=j.title,P=j.modalVisible,f=j.hideModal,N=j.modalContent,R=j.footer,x=j.modalWidth;return(0,U.jsx)(D.Z,{title:S,open:P,onCancel:f,footer:R,width:x,children:N})};A.Z=L}}]);
